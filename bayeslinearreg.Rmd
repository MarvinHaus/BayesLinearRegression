---
title: "Bayesian Linear Regression"
author: "Marvin Hauser, Sarem Seitz"
date: "11 August 2017"
output: html_document
---

```{r setup, include=FALSE}
library(MCMCpack)
library(truncnorm)
```


## Log-Likelihood Funktion
Berechnet die logarithmierte Likelihood - Matrixschreibweise wurde gewählt um Schleifen zu vermeiden:

```{r loglikelihood}
logLikelihood = function(X,y,betas,sd)
{
  yHat = X%*%betas
  sumLikelihoods = sum(
                      dnorm(y, mean=yHat, sd = sd, log = TRUE)
                      )
  return(sumLikelihoods)
}
```

Berechnet logarithmierte 'Likelihood'-Werte der Prior Verteilungen und summiert diese auf

```{r loglikePrior}
logPriors = function(betas,sd, meanNormalPrior = 0, sdNormalPrior = 5, shapeInvGammaPrior=1)
{
  lenBetas = length(betas)
  
  sumLogBetasPrior = sum(
                        dnorm(betas, mean = rep(meanNormalPrior,lenBetas),
                                      sd = rep(sdNormalPrior,lenBetas, log = TRUE)
                        )
                      )
  
  logSdPrior = log(dinvgamma(sd, shape=shapeInvGammaPrior))
  
  return(sumLogBetasPrior + logSdPrior)
}
```




posterior <- function(X, y, betas, sd, meanNormalPrior=0, sdNormalPrior=5, shapeInvGammaPrior=1){
  
  return (
          logLikelihood(X, y, betas, sd) +
          logPriors(betas, sd, meanNormalPrior, sdNormalPrior, shapeInvGammaPrior)
          )
}











## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
